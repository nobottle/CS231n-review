# CS231n Lec5. Convolutional Neural Networks

![스크린샷 2023-03-13 오후 1.24.24.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.24.24.png)

컨볼루션 뉴런 네트워크이다 convolutional nerual network CNN이라고 불리는 이 것은 이미지 인식에서 굉장히 많이 사용이 된다 이걸 사용하기 까지 역사를 간략하게 살펴보자

![스크린샷 2023-03-13 오후 1.25.46.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.25.46.png)

처음은 Mark1 perceptron이다 단층 퍼셉트론 방식, w값들을 일일히 조정하면서 훈련시킴

![스크린샷 2023-03-13 오후 1.26.47.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.26.47.png)

그 다음 adaline아달라인 방식, 역시 기계로 숫자를 조절하면서 진행

![스크린샷 2023-03-13 오후 1.27.30.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.27.30.png)

2006년에 나온 RBM-initialized,fine tuning방법

![스크린샷 2023-03-13 오후 1.28.39.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.28.39.png)

2012년에 image net에서 alex가 제시한 알렉스 넷

이때 사용한 방법이 CNN이고 급격하게 딥러닝이 발전하게 되엇다

큰것부저 작은것,섬세한 영역까지 점차 들어가고,어떤 것을 볼때마다 활성화 되는게 다르게 되는지 분석하고 큰것>섬세한것으로 분석해낸다

CNN은 다양한 분야에서 사용된다

![스크린샷 2023-03-13 오후 1.32.57.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.32.57.png)

이런 Detection과 각 픽셀에 라벨링을 하는 segmentation에도 사용된다

또한 Lidar를 통해 자율주행, face recognition이나 비디오 인식,pose recognition과 게임

![스크린샷 2023-03-13 오후 1.34.52.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.34.52.png)

의학영상해석,진단,은하나 표지판 인식에도 사용,고래분류나 항공지도를 통한 결과 건물을 인식하는데나

![스크린샷 2023-03-13 오후 1.35.36.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.35.36.png)

사진을 보고 이미지에 대한 설명을 하는 image captioning에도 사용 된다

여기서 text generation을 하는것을 RNN이라고 한다

또한 그림을 그리거나 특정 화풍으로 그림을 그리는 style transfer에도 사용

그렇다면 CNN에 대해 자세히 알아보도록 하자

![스크린샷 2023-03-13 오후 1.37.42.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.37.42.png)

이전에는 이 FC layer에 대해 배웠다 input이미지를 늘려 w와 곱해 activation layer로 출력

근데 이 방법은 몇개의 안좋은 문제가 나타난다 그래서 바꾼 방법이

![스크린샷 2023-03-13 오후 2.03.57.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.03.57.png)

이거다 3이 같은 이유는 색상을 가리키는 depth이거는 같아야 하고 저 filter를 convolove filter라고 두는데

이 필터를 이용해 저 input이미지에서 이미지의 특징을 뽑아내 걸러낸다

이런 입력 이미지에 filter를 슬라이딩하여 내적을 구하는 것을 convolve라고 함

![스크린샷 2023-03-13 오후 2.05.54.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.05.54.png)

그래서 이 필터를 가지고 하나의 지역에 대해 하나의 값을 뽑아냄 filter를 w라 하면 w의 전체 값과 곱하기x그리고 bias를 더함

이러면 새로운 하나의 값이 나오게 됨

위그림에서 그러면 wtx는 5*5*3=75이고 b는 bias다

![스크린샷 2023-03-13 오후 2.08.03.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.08.03.png)

32x32x3 이미지에 5x5x3 convolve filter를  거치게 되면 28x28x1의 하나의 activation map이 나오게 된다 이 map의 크기는 filter의 크기와 숫자, 슬라이딩을 어케하냐에 따라 달라진다. 이거는 또한 하나의 층이 된다

![스크린샷 2023-03-13 오후 2.10.01.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.10.01.png)

각 필터는 이미지로부터 1개의 특징을 추출하는데, CNN에는 여러 개의 필터를 사용하므로 이미지로부터 여러 개 특징을 추출 가능 위 그림을 보면 1개의 필터만 쓰는게 아닌 여러개의 필터를 사용

만약 다른 필터를 사용햇다고 가정하면 초록색 필터가 나오게 됨 (위 그림과 같이)

![스크린샷 2023-03-13 오후 2.11.25.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.11.25.png)

6개를 사용했다? 6개의 activation map이 나오게 됨 여기서는 depth가 바뀜 6개니까

28X28X6의 ‘새 이미지를' 얻엇다고 생각하면 된다

![스크린샷 2023-03-13 오후 2.25.36.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.25.36.png)

두개를 거치는 과정이다

32x32x3의 입력 이미지를 6개의 5x5x3(입력이미지 depth가3이므로 필터 depth도 3)의 필터로 내적하여 28x28x6(필터의 개수가 6개 이므로 depth가6)의 activation map을 얻는다 이 map은 다시 입력 이미지가 되어 10개의 5x5x6(입력 이미지 depth가 6이므로)의 필터와 내적을 하고 24x24x10(필터의 개수가 10개이므로 depth가10)의 activation map을 얻는다 이거를 계속 반복

![스크린샷 2023-03-13 오후 2.29.33.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.29.33.png)

시각화해보면 위와 같이 나오게 된다

첫번째 필터는 edges나 color를 학습, 두번째 필터에서는 corner,blobs,를 학습 세번째 필터에서는 high level features(통합)을 학습한다. convolutional layer가 깊어질 수록 이미지의 특징을 더 많이 추출ㅇ해 냄

![스크린샷 2023-03-13 오후 2.31.22.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.31.22.png)

위는 32개의 5x5 필터를 통해 나온 32개의 activation map이 각각 어떻게 표현되는지를 시각적으로 보여주고 있다 

![스크린샷 2023-03-13 오후 2.51.23.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.51.23.png)

위는 층을 쌓아가는 과정을 설명한건데

convilution layer에 활성함수인 Lelu를 쌓고, activationa map의 크기를 줄여주는 pooling layer를 쌓는 과정을 여러번 한 후 마지막에 Fully connected layer을 쌓아 이비지를 클래스별로 분류한다 위 사진에는 근데 왜 검정색만 있을까? ReLu를 거치기 때문 이 함수는 0이하의 값들은 전부0으로 만듬 -값들이 전부 없어진다고 보면됨

그래서 검정색 ReLu전에는 -값을 하지 않으니 회색도 잇는거

RGB값 또한 3개를 전부 한게 아닌 하나의 depth만 가져와서 grey계열로 나오게 되는거다

![스크린샷 2023-03-13 오후 2.54.47.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.54.47.png)

![스크린샷 2023-03-13 오후 2.55.13.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.55.13.png)

필터가 어떻게 이미지를 슬라이딩하는지 알아보도록 하자

7x7의 Input과 3x3의 filter가 잇다 stride는1로 가정

depth가 3이면 똑같이 3을 곱하면 됨

![스크린샷 2023-03-13 오후 2.57.36.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.57.36.png)

필터가 오른쪽으로 한칸 움직이면서 슬라이딩 한다 여기서 하나의 값을 또 뽑아내고,,

![스크린샷 2023-03-13 오후 2.58.27.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.58.27.png)

여기서도,,,

![스크린샷 2023-03-13 오후 2.58.40.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.58.40.png)

여기서도,,,

![스크린샷 2023-03-13 오후 2.59.18.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.59.18.png)

이렇게 7X7에서 3x3filter가 움직일 수 잇는거리는 5번 세로도 똑같당

그래서 Output이 5x5가 나옴

즉 32x32에서 5x5필터를 이용하면 28x28이 나왓던 이유가 이거다

만약 stride가 2면 어떨까?

![스크린샷 2023-03-13 오후 3.12.53.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.12.53.png)

2개씩 뛰어넘으니 output값은 당연히 작아진다

근데만약 stride가 3이면…?

![스크린샷 2023-03-13 오후 3.14.59.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.14.59.png)

fit하지가 않다 3이면 전부다 둘러볼 수가 없기 때문

이 과정을 공식으로 살펴보면

![스크린샷 2023-03-13 오후 3.18.00.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.18.00.png)

N은 input size다 F는 filter의 크기

(N-F)/stride + 1의 값이 output사이즈 이게 딱 떨어지지 않으면 값이 안나오고

그래서 stride가 3일때 값이 2.33이렇게 나오므로 activation map은 잘 동작하지 않는 거다…

![스크린샷 2023-03-13 오후 3.19.32.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.19.32.png)

이런 문제를 해결하기 위해 나오는 것이 padding의 개념이다 일반적인 방법은 입력이미지에 zero padding을 하는 것 즉 입력 이미지의 바깥에 0으로 이루어진 pixel을 붙여준다는 거

더 정리하자면…

이미지가 stride를 거칠 수록 사이즈는 작아지게 된다, 그런데 이게 이미지가 작아지다 보면 cnn층을 많이 쌓지도 않았는데 image는 없어지게 됨 그리고 중간에 있는 영역들은 filter들이 중복해서 겹쳐서 보게 됨,그러나 양쪽 끝 부분 side부분은 중간에 비해서 덜 보게 된다 >>이거는 문제가 될 가능성 잇음

일단 뭐 가장 큰 문제는 image size가 작아진다는 것

여기서 Padding개념은 zero padding을 통해 양쪽 사이드에 zero값을 둘러줌

즉 padding을 1개 추가하게 되면 양 사이드 왼,오른쪽이니까 x2

7x7의 이미지가 9x9가 됨 padding이 2개 layer가 추가되면 2x2=4개의 숫자가 증가되어 11x11

이거를 위에 아까 이미지에 적용하면?

![스크린샷 2023-03-13 오후 3.23.38.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.23.38.png)

7X7이 나옴 일단 padding한개는 양쪽에 추가가 되므로 9X9가 됨 그래서 9-3/1+1을 하면 7

![스크린샷 2023-03-13 오후 3.24.31.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.24.31.png)

그래서 일반적으로 filter가 3이면 zero pad을 1개만 하고 filger가 5면 zero pad를 2개 한다는 말

일반적으로 이렇게 사용한다고 한다! (파란색 부분)

![스크린샷 2023-03-13 오후 3.26.56.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.26.56.png)

결국은 padding을 써야 이미지 크기가 줄어드는 것을 방지할 수 잇다고 하는거를 설명

그리고 식을 정리해보면

NxN입력 이미지에 P만큼 zero padding을 한 후,k개의 FxF의 필터를 stride만큼 슬라이딩 하면

A=(N+2*P-F)/stride + 1이 나오고 K개의 필터이므로 activation map의 크기는 AxAxK이다

![스크린샷 2023-03-13 오후 3.29.34.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.29.34.png)

그렇다면 이 층에서 사용하는 파라미터의 개수는 몇 개 일까?? 760개가 된다

5x5X3은 75인데 10개가 잇다 그러면 750 거기에다가 각 biasr값이 필터마다 잇으니 +10

그러면 760개

![스크린샷 2023-03-13 오후 3.31.01.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.31.01.png)

수학적으로 일반화한 식이다 정리하자면

ConvNet에 필요한 하이퍼파라미는 필터의 수인 K, 필터의 크기F, 보폭S zero Padding의 수인 P여기서

필터의 개수인 K는 일반적으로 2**n(32,64,128,512)이런식으로 정함

![스크린샷 2023-03-13 오후 3.32.38.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.32.38.png)

그리고 1x1 conv의 내용

여기서는 5x5이런식이 아닌 1x1을 사용

CNN을 거치고 나서 Flattendmf gksrj

즉 행렬을 쪼가 펴서 input으로 Fully connected layer에 넣게 되는데 이 때 FC를 뺴고 1x1 ConV를 바로 써도 괜찮다고 함 연산이 같에 나온다고 함

정리하자면 56x56x64의 입력이미지에 32개의 필터를 1x1conv한다는 것은 1x1x64인 64개의 필터가 잇고 64차원을 내적한다는 뜻, 그 결과로 56x56x32의 acrtivation map이 나옴 참고로 1x1의  convountion layer는 pooling과 비슷

---

1x1xD의 convolution은 차원을 줄여주는 역할을 한다. 100x100x512의 입력 이미지를 D개의 1x1x512 필터로 convolve하면 출력 이미지의 크기는 100x100xD이 된다. D개의 1x1x512 필터는 수학적으로 FC layer와 같다. 다만 FC layer는 고정된 크기를 가지는 입력 이미지를 가지지만 convolution layer는 100x100과 비슷하거나 공간적으로 더 큰 입력 이미지를 받아들인다는 점이 다르다. 따라서 FC layer와 D개의 1x1x512 필터는 서로 대체할 수 있다. 따라서 D개의 1x1x512 필터가 네트워크의 마지막에 존재하면 FC layer와 같은 역할을 수행한다.

---

위에 글은 인용한 내용

![스크린샷 2023-03-13 오후 3.37.09.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.37.09.png)

뉴런의 관점을 ㅗ보면 convoultion layer는 local connectivity를 가진 뉴런과 같다(1구역은1노드가 담당)

즉 하나의 filter에 대한 영역에서 1개의 숫자가 나오게 된다는거

![스크린샷 2023-03-13 오후 3.38.21.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.38.21.png)

만약 5개면 같은 영역에 대해5개의 값이 나오게 된다

![스크린샷 2023-03-13 오후 3.38.53.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.38.53.png)

이런식으로,,, 하지만5개는 각각 다른 특징을 가지고 잇다 필터가 다르니까

결국 같은 영역에서도 필터가 다르니까 서로 다른 값들을 뽑아낸다는 것이다

그렇다면 pooling이란?

![스크린샷 2023-03-13 오후 3.39.54.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.39.54.png)

pooling은 이미지의 사이즈를 줄여준다 근데 큰 특징값은 유지하되 줄여주는 거다

그래서 보통 max pooling을 많이 사용

Max pooling은 큰 값을 뽑아내는 것인데 여기서 큰 값이란 특징의 값이 큰거를 의미한다

![스크린샷 2023-03-13 오후 3.40.52.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.40.52.png)

max pooldl 2x2면 크기가 절반으로 줄어듬 빨간색 영역중에서는6,초록색부분에서는8이 제일 크니

이 값들만 뽑아내는거 노란색 파란색도 적용해보면 오른쪽과 같은 결과가 나온다 

즉 stride로 줄여가는게 아닌 max pooling을 이용해서 이미지의 size를 줄여주는 것

![스크린샷 2023-03-13 오후 3.42.36.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.42.36.png)

이거는 요약한 식이다!

![스크린샷 2023-03-13 오후 3.42.52.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.42.52.png)

일반적으로 pooling filter가 2면 stride가 2,3이여도 2를 사용한다고 함

그리고 마지막에 FC layer로 넣어줘서 값들을 분류

![스크린샷 2023-03-13 오후 3.43.29.png](CS231n%20Lec5%20Convolutional%20Neural%20Networks%20b24a451b3296488995970d0a99b80c30/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-13_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.43.29.png)

입력 이미지가 conv,ReLu,pooling layer를 통과 한 후 마지막으로 FC layer를 통과한다